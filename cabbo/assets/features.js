function initAnalytics(){const e=()=>{};document.querySelectorAll("button").forEach(t=>{t.addEventListener("click",()=>{e("button_click",{buttonText:t.textContent.trim(),timestamp:(new Date).toISOString()})})}),document.querySelectorAll("form").forEach(t=>{t.addEventListener("submit",()=>{const n=new FormData(t);Object.fromEntries(n.entries());e("form_submission",{formId:t.id,formType:t.getAttribute("data-form-type")||"unknown",timestamp:(new Date).toISOString()})})})}function createComprehensiveResearchSurvey(){const e=document.createElement("div");e.id="research-survey-modal",e.className="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center",e.innerHTML=`\n        <div class="bg-white rounded-2xl p-8 max-w-3xl w-full max-h-[90vh] overflow-y-auto relative">\n            <button id="close-research-survey-modal" class="absolute top-4 right-4 text-2xl text-brand-charcoal hover:text-brand-green transition-colors">\n                &times;\n            </button>\n            <h2 class="text-2xl font-bold text-brand-green mb-6">AI in Agriculture: Research Survey</h2>\n            \n            <form id="comprehensive-research-survey" data-form-type="research-survey">\n                <div class="grid md:grid-cols-2 gap-6">\n                    <div>\n                        <h3 class="text-xl font-semibold text-brand-sage mb-4">Personal Information</h3>\n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">Name</label>\n                            <input type="text" name="name" \n                                class="w-full px-4 py-2 border border-brand-sage rounded-xl" \n                                placeholder="Your full name" required>\n                        </div>\n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">Email</label>\n                            <input type="email" name="email" \n                                class="w-full px-4 py-2 border border-brand-sage rounded-xl" \n                                placeholder="Your email address" required>\n                        </div>\n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">Professional Role</label>\n                            <select name="role" \n                                class="w-full px-4 py-2 border border-brand-sage rounded-xl" required>\n                                <option value="">Select your role</option>\n                                <option value="farmer">Farmer</option>\n                                <option value="researcher">Agricultural Researcher</option>\n                                <option value="consultant">Agricultural Consultant</option>\n                                <option value="student">Student</option>\n                                <option value="other">Other</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div>\n                        <h3 class="text-xl font-semibold text-brand-sage mb-4">AI Insights</h3>\n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">AI Familiarity Level</label>\n                            <div class="flex space-x-4">\n                                ${["Not Familiar","Somewhat Familiar","Very Familiar"].map(e=>`\n                                    <label class="inline-flex items-center">\n                                        <input type="radio" name="ai-familiarity" \n                                            value="${e.toLowerCase().replace(" ","-")}" \n                                            class="form-radio text-brand-green" required>\n                                        <span class="ml-2">${e}</span>\n                                    </label>\n                                `).join("")}\n                            </div>\n                        </div>\n                        \n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">Key Agricultural Challenges</label>\n                            <textarea name="challenges" \n                                class="w-full px-4 py-2 border border-brand-sage rounded-xl" \n                                rows="4" \n                                placeholder="Describe the main challenges you face in agriculture" required></textarea>\n                        </div>\n                        \n                        <div class="mb-4">\n                            <label class="block mb-2 text-brand-charcoal">AI Solution Interest</label>\n                            <div class="flex items-center space-x-4">\n                                <span>Low</span>\n                                ${[1,2,3,4,5].map(e=>`\n                                    <label class="inline-flex items-center">\n                                        <input type="radio" name="ai-interest" \n                                            value="${e}" \n                                            class="form-radio text-brand-green" required>\n                                        <span class="ml-1">${e}</span>\n                                    </label>\n                                `).join("")}\n                                <span>High</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="mt-6">\n                    <button type="submit" \n                        class="w-full bg-brand-green text-white px-6 py-3 rounded-xl hover:bg-green-700 transition-colors">\n                        Submit Research Insights\n                    </button>\n                </div>\n            </form>\n        </div>\n    `,document.body.appendChild(e);const t=document.getElementById("research-survey-modal"),n=document.getElementById("close-research-survey-modal"),a=document.getElementById("comprehensive-research-survey"),o=()=>{t.classList.remove("flex"),t.classList.add("hidden")};n.addEventListener("click",o),t.addEventListener("click",e=>{e.target===t&&o()}),a.addEventListener("submit",async e=>{e.preventDefault();const t=new FormData(a),n=Object.fromEntries(t.entries()),o=new FormData;o.append("name",n.name),o.append("email",n.email),o.append("role",n.role),o.append("ai-familiarity",n["ai-familiarity"]),o.append("challenges",n.challenges),o.append("ai-interest",n["ai-interest"]),o.append("type","research-survey");try{if(!(await fetch("https://formspree.io/f/mpwlvgyy",{method:"POST",body:o,headers:{Accept:"application/json"}})).ok)throw new Error("Submission failed");a.innerHTML='\n                    <div class="text-center">\n                        <h3 class="text-2xl font-bold text-brand-green mb-4">Thank You!</h3>\n                        <p class="text-brand-charcoal mb-6">\n                            Your insights have been sent to our team and are valuable in shaping the future of AI in agriculture.\n                        </p>\n                        <button onclick="document.getElementById(\'research-survey-modal\').classList.add(\'hidden\')" \n                            class="bg-brand-green text-white px-6 py-3 rounded-xl">\n                            Close\n                        </button>\n                    </div>\n                '}catch(e){const t=`AI in Agriculture Research Survey Response:\n            \nName: ${n.name||"N/A"}\nEmail: ${n.email||"N/A"}\nRole: ${n.role||"N/A"}\nAI Familiarity: ${n["ai-familiarity"]||"N/A"}\nChallenges: ${n.challenges||"N/A"}\nAI Interest: ${n["ai-interest"]||"N/A"}/5\n\nSubmitted at: ${(new Date).toLocaleString()}`,o=`mailto:support@example.com?subject=Research Survey Response - AI in Agriculture&body=${encodeURIComponent(t)}`;window.open(o),a.innerHTML='\n                <div class="text-center">\n                    <h3 class="text-2xl font-bold text-brand-green mb-4">Thank You!</h3>\n                    <p class="text-brand-charcoal mb-6">\n                        Your insights have been sent via email and are valuable in shaping the future of AI in agriculture.\n                    </p>\n                    <button onclick="document.getElementById(\'research-survey-modal\').classList.add(\'hidden\')" \n                        class="bg-brand-green text-white px-6 py-3 rounded-xl">\n                        Close\n                    </button>\n                </div>\n            '}})}function enhanceAccessibility(){document.querySelectorAll("button:not([aria-label])").forEach(e=>{e.setAttribute("aria-label",e.textContent.trim())}),document.addEventListener("keydown",e=>{if("Escape"===e.key){document.querySelectorAll(".fixed.flex").forEach(e=>{e.classList.remove("flex"),e.classList.add("hidden")})}})}function implementLazyLoading(){const e=document.querySelectorAll("img");if("loading"in HTMLImageElement.prototype)e.forEach(e=>{e.setAttribute("loading","lazy")});else{const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src||n.src,t.unobserve(n)}})});e.forEach(e=>{e.dataset.src&&t.observe(e)})}}function showSurveyModal(){const e=document.getElementById("survey-modal");e&&e.remove();const t=window.i18n,n=e=>t?t.get(`modals.survey.${e}`,e):e,a=document.createElement("div");a.id="survey-modal",a.className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",a.innerHTML=`\n        <div class="bg-white rounded-2xl max-w-6xl w-full h-[95vh] flex flex-col relative shadow-2xl">\n            <!-- Header - Fixed -->\n            <div class="bg-gradient-to-r from-brand-green to-green-600 text-white p-4 md:p-6 flex-shrink-0">\n                <button id="close-survey-modal" class="absolute top-4 right-4 text-2xl hover:text-green-200 transition-colors z-10">\n                    &times;\n                </button>\n                <h2 class="text-xl md:text-2xl font-bold mb-1 md:mb-2 pr-8">${n("title")}</h2>\n                <p class="text-green-100 text-sm md:text-base">${n("subtitle")}</p>\n            </div>\n            \n            <!-- Content - Scrollable -->\n            <div class="flex-1 overflow-y-auto p-4 md:p-6">\n                <!-- Initial Options View -->\n                <div id="survey-options-view">\n                    <div class="text-center mb-6">\n                        <div class="w-12 h-12 md:w-16 md:h-16 bg-brand-green rounded-full flex items-center justify-center mx-auto mb-4">\n                            <svg class="w-6 h-6 md:w-8 md:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n                            </svg>\n                        </div>\n                        <h3 class="text-lg md:text-xl font-semibold text-brand-charcoal mb-2">${n("quickSurvey")}</h3>\n                        <p class="text-brand-charcoal text-sm md:text-base">${n("description")}</p>\n                    </div>\n                    \n                    <!-- Survey Options -->\n                    <div class="space-y-4 mb-6">\n                        <div class="bg-brand-offwhite rounded-xl p-4 border-l-4 border-brand-green">\n                            <h4 class="font-semibold text-brand-charcoal mb-2">${n("option1Title")}</h4>\n                            <p class="text-sm text-brand-charcoal mb-3">${n("option1Description")}</p>\n                            <button id="open-survey-tab" class="bg-brand-green text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">\n                                ${n("option1Button")}\n                            </button>\n                        </div>\n                        \n                        <div class="bg-brand-offwhite rounded-xl p-4 border-l-4 border-brand-sage">\n                            <h4 class="font-semibold text-brand-charcoal mb-2">${n("option2Title")}</h4>\n                            <p class="text-sm text-brand-charcoal mb-3">${n("option2Description")}</p>\n                            <button id="embed-survey" class="bg-brand-sage text-white px-4 py-2 rounded-lg hover:bg-sage-700 transition-colors">\n                                ${n("option2Button")}\n                            </button>\n                        </div>\n                    </div>\n                    \n                    <!-- Footer -->\n                    <div class="text-center text-sm text-brand-charcoal">\n                        <p>${n("footer")}</p>\n                    </div>\n                </div>\n                \n                <!-- Embedded Survey View (initially hidden) -->\n                <div id="embedded-survey-view" class="hidden h-full flex flex-col">\n                    <!-- Survey Header -->\n                    <div class="bg-brand-offwhite rounded-xl p-4 mb-4 flex-shrink-0">\n                        <div class="flex items-center justify-between">\n                            <div>\n                                <h3 class="font-semibold text-brand-charcoal">${n("surveyTitle")}</h3>\n                                <p class="text-sm text-brand-charcoal">${n("surveyInstructions")}</p>\n                            </div>\n                            <button id="back-to-options" class="bg-brand-sage text-white px-3 py-1 rounded-lg hover:bg-sage-700 transition-colors text-sm">\n                                ${n("backButton")}\n                            </button>\n                        </div>\n                    </div>\n                    \n                    <!-- Survey Container - Takes remaining space -->\n                    <div class="flex-1 bg-gray-50 rounded-xl p-2 md:p-4 min-h-0">\n                        <iframe \n                            id="survey-iframe"\n                            src="https://docs.google.com/forms/d/e/1FAIpQLSfvG9EJTo6Ckd9bbp9277j09EvxILC7Q-P8io0Y7vpw4HS0nA/viewform?embedded=true" \n                            class="w-full h-full rounded-lg"\n                            frameborder="0" \n                            marginheight="0" \n                            marginwidth="0"\n                            style="min-height: 500px;">\n                            Loading\u2026\n                        </iframe>\n                    </div>\n                    \n                    <!-- Survey Footer -->\n                    <div class="bg-brand-offwhite rounded-xl p-4 mt-4 flex-shrink-0">\n                        <div class="flex flex-col sm:flex-row items-center justify-between gap-4">\n                            <div class="text-sm text-brand-charcoal">\n                                <p>${n("tip")}</p>\n                            </div>\n                            <div class="flex gap-2">\n                                <button id="open-survey-tab-alt" class="bg-brand-green text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm">\n                                    ${n("openInNewTab")}\n                                </button>\n                                <button id="close-survey-modal-alt" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors text-sm">\n                                    ${n("close")}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,document.body.appendChild(a),document.getElementById("close-survey-modal").addEventListener("click",()=>{a.remove()}),document.getElementById("close-survey-modal-alt").addEventListener("click",()=>{a.remove()}),document.getElementById("open-survey-tab").addEventListener("click",()=>{window.open("https://docs.google.com/forms/d/e/1FAIpQLSfvG9EJTo6Ckd9bbp9277j09EvxILC7Q-P8io0Y7vpw4HS0nA/viewform?usp=dialog","_blank"),a.remove()}),document.getElementById("open-survey-tab-alt").addEventListener("click",()=>{window.open("https://docs.google.com/forms/d/e/1FAIpQLSfvG9EJTo6Ckd9bbp9277j09EvxILC7Q-P8io0Y7vpw4HS0nA/viewform?usp=dialog","_blank"),a.remove()}),document.getElementById("embed-survey").addEventListener("click",()=>{document.getElementById("survey-options-view").classList.add("hidden"),document.getElementById("embedded-survey-view").classList.remove("hidden"),setTimeout(()=>{const e=document.getElementById("survey-iframe");e&&e.focus()},100)}),document.getElementById("back-to-options").addEventListener("click",()=>{document.getElementById("embedded-survey-view").classList.add("hidden"),document.getElementById("survey-options-view").classList.remove("hidden")}),a.addEventListener("click",e=>{e.target===a&&a.remove()});const o=document.getElementById("survey-iframe");o&&(o.addEventListener("load",()=>{o.style.opacity="1"}),o.style.opacity="0.8",o.style.transition="opacity 0.3s ease")}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('button[data-action="request-early-access"]').forEach(e=>{e.addEventListener("click",()=>{const e=document.getElementById("newsletter");e&&e.scrollIntoView({behavior:"smooth"})})});document.querySelectorAll('button[data-action="answer-survey"]').forEach(e=>{e.addEventListener("click",()=>{showSurveyModal()})});document.querySelectorAll('button[data-action="see-use-cases"]').forEach(e=>{e.addEventListener("click",()=>{const e=document.getElementById("use-cases");e&&e.scrollIntoView({behavior:"smooth"})})})}),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),document.addEventListener("DOMContentLoaded",()=>{initAnalytics(),enhanceAccessibility(),implementLazyLoading();document.querySelectorAll('button[data-action="request-early-access"]').forEach(e=>{e.addEventListener("click",()=>{const e=document.getElementById("newsletter");e&&e.scrollIntoView({behavior:"smooth"})})})}),window.Cabbo={createResearchSurvey:createComprehensiveResearchSurvey,showSurveyModal:showSurveyModal};