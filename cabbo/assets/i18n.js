class I18n{constructor(){this.currentLanguage="en",this.translations={},this.loaded=!1,this.supportedLanguages=["en","it"]}async init(t=null){t||(t=this.detectLanguage()),this.supportedLanguages.includes(t)||(t="en"),this.currentLanguage=t,await this.loadTranslations(),this.loaded=!0,this.updatePageContent(),this.hideLoadingScreen(),window.dispatchEvent(new CustomEvent("i18nReady",{detail:{language:this.currentLanguage,translations:this.translations}}))}detectLanguage(){const t=localStorage.getItem("preferredLanguage");if(t&&this.supportedLanguages.includes(t))return t;const e=navigator.language||navigator.userLanguage;if(e){const t=e.split("-")[0].toLowerCase();if(this.supportedLanguages.includes(t))return t}return"en"}async loadTranslations(){try{const t=document.querySelector("base")&&document.querySelector("base").getAttribute("href")||"",e=await fetch(`${t}${this.currentLanguage}.json`);if(!e.ok)throw new Error(`Failed to load ${this.currentLanguage}.json`);this.translations=await e.json()}catch(t){"en"!==this.currentLanguage&&(this.currentLanguage="en",await this.loadTranslations())}}get(t,e=""){if(!this.loaded)return e;const a=t.split(".");let n=this.translations;for(const t of a){if(!n||"object"!=typeof n||!(t in n))return e;n=n[t]}return n||e}updateMetaTags(){const t=this.get("meta.title"),e=this.get("meta.description"),a=this.get("meta.ogTitle"),n=this.get("meta.ogDescription");if(t&&(document.title=t),e){const t=document.querySelector('meta[name="description"]');t&&t.setAttribute("content",e)}if(a){const t=document.querySelector('meta[property="og:title"]');t&&t.setAttribute("content",a)}if(n){const t=document.querySelector('meta[property="og:description"]');t&&t.setAttribute("content",n)}}updateNavigation(){}updateHero(){}updateSections(){this.updateDataI18nElements()}updateDataI18nElements(){document.querySelectorAll("[data-i18n]").forEach(t=>{const e=t.getAttribute("data-i18n");if(e)if("cookieBanner.message"===e){const a=this.get(e),n=this.get("footer.cookiePolicy");t.innerHTML=a.replace("Cookie Policy",`<a href="cookie-policy.html" target="_blank">${n}</a>`)}else if("footer.copyright"===e){const a=this.get(e);t.innerHTML=a.replace("Cabbo",'<a href="https://rossettisimone.github.io/cabbo" class="text-brand-green hover:underline">Cabbo</a>')}else t.textContent=this.get(e)});document.querySelectorAll("[data-i18n-placeholder]").forEach(t=>{const e=t.getAttribute("data-i18n-placeholder");e&&(t.placeholder=this.get(e))})}updateFooter(){}updateCookieBanner(){}updateCookiePreferences(){}updatePageContent(){this.updateMetaTags(),this.updateNavigation(),this.updateHero(),this.updateSections(),this.updateFooter(),this.updateCookieBanner(),this.updateCookiePreferences()}async changeLanguage(t){if(t!==this.currentLanguage&&this.supportedLanguages.includes(t)){this.showLoadingScreen(),this.currentLanguage=t,localStorage.setItem("preferredLanguage",t);try{await this.loadTranslations(),this.updatePageContent(),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:t,translations:this.translations}}))}catch(t){}finally{setTimeout(()=>{this.hideLoadingScreen()},500)}}}getSupportedLanguages(){return this.supportedLanguages}getLanguageDisplayNames(){return{en:"English",it:"Italiano"}}getCurrentLanguage(){return this.currentLanguage}getAllTranslations(){return this.translations}showLoadingScreen(){const t=document.getElementById("loading-screen");t&&(t.style.display="flex",t.style.opacity="1",t.style.transition="opacity 0.3s ease-in")}hideLoadingScreen(){const t=document.getElementById("loading-screen");t&&(t.style.opacity="0",t.style.transition="opacity 0.5s ease-out",setTimeout(()=>{t.style.display="none"},500))}}window.i18n=new I18n,document.addEventListener("DOMContentLoaded",async()=>{await window.i18n.init()});