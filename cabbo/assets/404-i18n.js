class Error404I18n{constructor(){this.currentLanguage=localStorage.getItem("preferredLanguage")||"en",this.translations={},this.loaded=!1,this.init()}async init(){try{await this.loadTranslations(),this.loaded=!0,this.applyTranslations(),this.initLanguageSwitcher(),window.addEventListener("languageChanged",()=>{this.currentLanguage=window.i18n?window.i18n.currentLanguage:"en",localStorage.setItem("preferredLanguage",this.currentLanguage),this.loadTranslations().then(()=>{this.applyTranslations()})})}catch(t){}}async loadTranslations(){try{const t=await fetch(`${this.currentLanguage}.json`);this.translations=await t.json()}catch(t){this.currentLanguage="en";const e=await fetch("en.json");this.translations=await e.json()}}get(t,e=""){const n=t.split(".");let a=this.translations;for(const t of n){if(!a||"object"!=typeof a||!(t in a))return e;a=a[t]}return a||e}applyTranslations(){this.updatePageMeta(),this.updateDataI18nElements()}updatePageMeta(){const t=this.get("error404.title","404 - Page Not Found"),e=this.get("error404.description","The page you're looking for doesn't exist. Return to Cabbo's homepage.");document.title=`${t} - Cabbo: AI-Powered Agricultural Decision Support System`;const n=document.querySelector('meta[name="description"]');n&&n.setAttribute("content",e),document.documentElement.lang=this.currentLanguage}updateDataI18nElements(){document.querySelectorAll("[data-i18n]").forEach(t=>{const e=t.getAttribute("data-i18n");e&&(t.textContent=this.get(e))})}initLanguageSwitcher(){const t=document.getElementById("language-switcher"),e=document.getElementById("language-dropdown"),n=document.getElementById("current-language"),a=document.querySelectorAll(".language-option");if(!t||!e)return;let i=!1;const r=()=>{const t={en:"EN",it:"IT"};n&&(n.textContent=t[this.currentLanguage]||"EN")},s=()=>{i=!i,i?e.classList.remove("hidden"):e.classList.add("hidden")},o=()=>{i=!1,e.classList.add("hidden")};t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),s()});const c=n=>{t.contains(n.target)||e.contains(n.target)||o()},d=t=>{"Escape"===t.key&&o()};document.addEventListener("click",c),document.addEventListener("keydown",d),a.forEach(t=>{t.addEventListener("click",async e=>{e.preventDefault();const n=t.getAttribute("data-lang");if(n&&n!==this.currentLanguage){this.showLoadingScreen(),this.currentLanguage=n,localStorage.setItem("preferredLanguage",n);try{await this.loadTranslations(),this.applyTranslations(),r(),o()}catch(t){}finally{setTimeout(()=>{this.hideLoadingScreen()},500)}}})}),r()}}document.addEventListener("DOMContentLoaded",()=>{window.error404I18n=new Error404I18n});